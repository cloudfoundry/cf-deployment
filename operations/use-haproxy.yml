- type: replace
  path: /releases/-
  value:
    name: haproxy
    sha1: sha256:d08a76001025aefaf4febb3a6cad4f43edbe263d7cc11dd2c0353629a5356a8d
    url: https://bosh.io/d/github.com/cloudfoundry-incubator/haproxy-boshrelease?v=16.0.0%2B3.2.8
    version: 16.0.0+3.2.8
- type: remove
  path: /instance_groups/name=router/vm_extensions
- type: remove
  path: /instance_groups/name=tcp-router/vm_extensions
- type: remove
  path: /instance_groups/name=scheduler/vm_extensions
- type: replace
  path: /instance_groups/name=smoke-tests:before
  value:
    azs:
    - z1
    instances: 1
    jobs:
    - name: haproxy
      properties:
        ha_proxy:
          backend_ca_file: ((router_ssl.ca))
          backend_port: 443
          backend_ssl: verify
          ssl_pem: ((haproxy_ssl.certificate))((haproxy_ssl.private_key))
          tcp_link_port: 2222
      release: haproxy
    name: haproxy
    networks:
    - name: default
      static_ips:
      - ((haproxy_private_ip))
    stemcell: default
    vm_type: minimal
- type: replace
  path: /variables/-
  value:
    name: haproxy_ca
    options:
      common_name: haproxyCA
      is_ca: true
    type: certificate
- type: replace
  path: /variables/-
  value:
    name: haproxy_ssl
    options:
      alternative_names:
      - ((system_domain))
      - '*.((system_domain))'
      ca: haproxy_ca
      common_name: haproxySSL
    type: certificate
